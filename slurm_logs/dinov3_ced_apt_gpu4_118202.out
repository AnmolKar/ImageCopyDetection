Host: gpu4
Job ID: 118202
GPUs requested (per node): 2 [fallback to SBATCH --gres]
Torch processes per node: 2
OMP_NUM_THREADS set to 16 (CPUS_PER_TASK=32, NPROC_PER_NODE=2)
Starting run at Wed Nov 26 18:06:04 EST 2025
Wed Nov 26 18:06:54 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.14              Driver Version: 550.54.14      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A30                     On  |   00000000:31:00.0 Off |                    0 |
| N/A   29C    P0             32W /  165W |       0MiB /  24576MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A30                     On  |   00000000:4B:00.0 Off |                    0 |
| N/A   29C    P0             31W /  165W |       0MiB /  24576MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Launching torchrun at Wed Nov 26 18:06:55 EST 2025
Config: ExperimentConfig(disc21_root=PosixPath('/home/jowatson/Deep Learning/DISC21'), ndec_root=PosixPath('/home/jowatson/Deep Learning/NDEC'), model_name='facebook/dinov3-vitb16-pretrain-lvd1689m', img_size_train=224, img_size_eval=224, batch_size_train=32, batch_size_eval=32, batch_size_pairs=32, num_workers=4, lr_backbone=1e-05, lr_head=0.0001, weight_decay=0.0001, temperature_ntxent=0.2, temperature_kl=0.1, lambda_kl=1.0, lambda_local=1.0, lambda_bce=1.0, lambda_asl_mtr=1.0, num_epochs_disc21=30, num_epochs_ndec=20, early_stopping_patience_disc21=4, early_stopping_min_delta_disc21=5e-05, min_epochs_disc21=15, early_stopping_patience_ndec=2, early_stopping_min_delta_ndec=5e-05, min_epochs_ndec=5, checkpoint_path=PosixPath('artifacts/checkpoints/ced_apt_model_ddp.pt'))
World size: 2 | Rank: 0 | Local rank: 0
[DataLoader] Using num_workers=16, prefetch_factor=2, persistent_workers=True
Train images: 1,000,000
NDEC negative pairs batches (per rank): 1,563
[Checkpoint] No existing checkpoint at /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt, starting fresh.
[DISC21][Epoch 1] avg loss across ranks = 3.1470, BCE accuracy = 0.7378
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 2] avg loss across ranks = 3.1147, BCE accuracy = 0.7410
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 3] avg loss across ranks = 3.1091, BCE accuracy = 0.7422
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 4] avg loss across ranks = 3.1063, BCE accuracy = 0.7408
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 5] avg loss across ranks = 3.0996, BCE accuracy = 0.7411
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 6] avg loss across ranks = 2.7239, BCE accuracy = 0.7888
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 7] avg loss across ranks = 1.0311, BCE accuracy = 0.9510
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 8] avg loss across ranks = 0.8476, BCE accuracy = 0.9720
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 9] avg loss across ranks = 0.7988, BCE accuracy = 0.9765
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 10] avg loss across ranks = 0.7738, BCE accuracy = 0.9786
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 11] avg loss across ranks = 0.7588, BCE accuracy = 0.9797
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 12] avg loss across ranks = 0.7474, BCE accuracy = 0.9807
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 13] avg loss across ranks = 0.7374, BCE accuracy = 0.9810
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 14] avg loss across ranks = 0.7256, BCE accuracy = 0.9814
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 15] avg loss across ranks = 0.7176, BCE accuracy = 0.9817
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 16] avg loss across ranks = 0.7102, BCE accuracy = 0.9819
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 17] avg loss across ranks = 0.7046, BCE accuracy = 0.9820
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 18] avg loss across ranks = 0.6998, BCE accuracy = 0.9821
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 19] avg loss across ranks = 0.6919, BCE accuracy = 0.9824
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 20] avg loss across ranks = 0.6853, BCE accuracy = 0.9824
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
[DISC21][Epoch 21] avg loss across ranks = 0.6789, BCE accuracy = 0.9825
[Rank 0] Saved checkpoint to /home/jowatson/Deep Learning/Code/artifacts/checkpoints/ced_apt_model_ddp.pt
